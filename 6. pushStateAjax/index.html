<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>pushState Ajax</title>
	<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.6.3.js"></script>
	<script type="text/javascript">
		function httpGet(theUrl) { //ajax requset
		    var xmlHttp = null;

		    xmlHttp = new XMLHttpRequest();
		    xmlHttp.open("GET", theUrl, false);
		    xmlHttp.send(null);
		    return xmlHttp.responseText;
		}
		function get(){
			history.pushState( null, null, "text.txt" ); //改變網址的url
			change();
		}
		$(window).bind("popstate", function(e) {
            var returnLocation = history.location || document.location;
            if(returnLocation.href.indexOf("text.txt") != -1){
            	change();
            }else{
            	document.getElementById('file').innerHTML = "沒有檔案";	
            }
        });

        function change(){
        	document.getElementById('file').innerHTML = httpGet('http://localhost/Ajax/6.%20pushStateAjax/text.txt');
        }
	</script>
</head>
<body>
<input type="button" value="getText" onclick="get()">
<p id="file">沒有檔案</p>
</body>
</html>